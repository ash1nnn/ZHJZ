"use strict";const e=require("../../common/vendor.js");require("../../app.js");const i=require("../../api.js"),l={data(){return{scrollTop:0,userId:"",chatMsg:"",msgList:[]}},created(){this.initial()},computed:{windowHeight(){return this.rpxTopx(e.index.getSystemInfoSync().windowHeight)}},methods:{async initial(){const t=await i.myrequest(i.demandReplyInitialUrl,"GET",{userId:"userId=2&demandType=2"});console.log(t);let d=t.data[0].demand.demandId;console.log(d),e.index.setStorage({key:"demandId",data:d});let s={botContent:"你好我要留言",recordId:0,titleId:0,userContent:"",ansContent:"",userId:0};this.msgList.push(s);let a={botContent:t.data[0].demand.demandDesc,recordId:0,titleId:0,userContent:"",ansContent:"",userId:0};if(this.msgList.push(a),t.data[0].replyContent){let o={botContent:"",recordId:0,titleId:0,userContent:t.data[0].replyContent,ansContent:"",userId:0};this.msgList.push(o)}},rpxTopx(t){let s=750/e.wx$1.getSystemInfoSync().windowWidth*Number(t);return Math.floor(s)},async handleSend(){let t=e.index.getStorageSync("demandId");if(console.log(t),!this.chatMsg||!/^\s+$/.test(this.chatMsg)){let d={botContent:"",recordId:0,titleId:0,userContent:this.chatMsg,userId:0};this.msgList.push(d),e.index.request({url:"http://118.25.148.102:8080/demand/replyDemand",method:"POST",header:{"content-type":"application/json"},data:{userId:"4",replyContent:this.chatMsg,demandId:t},success:s=>{console.log(s)},fail:s=>{console.log(s)}}),this.chatMsg=""}else this.$modal.showToast("不能发送空白消息")}}};function h(t,d,s,a,o,r){return{a:e.f(o.msgList,(n,c,g)=>e.e({a:n.userContent!=""},n.userContent!=""?{b:e.t(n.userContent)}:{},{c:n.botContent!=""},n.botContent!=""?{d:e.t(n.botContent)}:{},{e:c})),b:`${r.windowHeight}rpx`,c:o.scrollTop,d:o.chatMsg,e:e.o(n=>o.chatMsg=n.detail.value),f:e.o((...n)=>r.handleSend&&r.handleSend(...n))}}const u=e._export_sfc(l,[["render",h],["__scopeId","data-v-0a863595"],["__file","C:/Users/lcz/Documents/GitHub/ZHJZ/pages/demond/demondAnswer.vue"]]);wx.createPage(u);
