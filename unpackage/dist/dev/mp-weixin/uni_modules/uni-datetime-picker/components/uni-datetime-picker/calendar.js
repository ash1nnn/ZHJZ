"use strict";const i=require("../../../../common/vendor.js"),c=require("./util.js"),D=require("./i18n/index.js"),g=()=>"./calendar-item.js",T=()=>"./time-picker.js",{t:r}=i.initVueI18n(D.i18nMessages),w={components:{calendarItem:g,timePicker:T},props:{date:{type:String,default:""},defTime:{type:[String,Object],default:""},selectableTimes:{type:[Object],default(){return{}}},selected:{type:Array,default(){return[]}},startDate:{type:String,default:""},endDate:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},range:{type:Boolean,default:!1},hasTime:{type:Boolean,default:!1},insert:{type:Boolean,default:!0},showMonth:{type:Boolean,default:!0},clearDate:{type:Boolean,default:!0},checkHover:{type:Boolean,default:!0},hideSecond:{type:[Boolean],default:!1},pleStatus:{type:Object,default(){return{before:"",after:"",data:[],fulldate:""}}},defaultValue:{type:[String,Object,Array],default:""}},data(){return{show:!1,weeks:[],calendar:{},nowDate:{},aniMaskShow:!1,firstEnter:!0,time:"",timeRange:{startTime:"",endTime:""},tempSingleDate:"",tempRange:{before:"",after:""},isPhone:!1}},watch:{date:{immediate:!0,handler(t){this.range||(this.tempSingleDate=t,setTimeout(()=>{this.init(t)},100))}},defTime:{immediate:!0,handler(t){this.range?(this.timeRange.startTime=t.start,this.timeRange.endTime=t.end):this.time=t}},startDate(t){this.cale&&(this.cale.setStartDate(t),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},endDate(t){this.cale&&(this.cale.setEndDate(t),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},selected(t){this.cale&&(this.cale.setSelectInfo(this.nowDate.fullDate,t),this.weeks=this.cale.weeks)},pleStatus:{immediate:!0,handler(t){const{before:s,after:e,fulldate:h,which:n}=t;this.tempRange.before=s,this.tempRange.after=e,setTimeout(()=>{if(h)if(this.cale.setHoverMultiple(h),s&&e){if(this.cale.lastHover=!0,this.rangeWithinMonth(e,s))return;this.setDate(s)}else this.cale.setMultiple(h),this.setDate(this.nowDate.fullDate),this.calendar.fullDate="",this.cale.lastHover=!1;else{if(!this.cale)return;this.cale.setDefaultMultiple(s,e),n==="left"&&s?(this.setDate(s),this.weeks=this.cale.weeks):e&&(this.setDate(e),this.weeks=this.cale.weeks),this.cale.lastHover=!0}},16)}}},computed:{timepickerStartTime(){return(this.range?this.tempRange.before:this.calendar.fullDate)===this.startDate?this.selectableTimes.start:""},timepickerEndTime(){return(this.range?this.tempRange.after:this.calendar.fullDate)===this.endDate?this.selectableTimes.end:""},selectDateText(){return r("uni-datetime-picker.selectDate")},startDateText(){return this.startPlaceholder||r("uni-datetime-picker.startDate")},endDateText(){return this.endPlaceholder||r("uni-datetime-picker.endDate")},okText(){return r("uni-datetime-picker.ok")},yearText(){return r("uni-datetime-picker.year")},monthText(){return r("uni-datetime-picker.month")},MONText(){return r("uni-calender.MON")},TUEText(){return r("uni-calender.TUE")},WEDText(){return r("uni-calender.WED")},THUText(){return r("uni-calender.THU")},FRIText(){return r("uni-calender.FRI")},SATText(){return r("uni-calender.SAT")},SUNText(){return r("uni-calender.SUN")},confirmText(){return r("uni-calender.confirm")}},created(){this.cale=new c.Calendar({selected:this.selected,startDate:this.startDate,endDate:this.endDate,range:this.range}),this.init(this.date)},mounted(){if(typeof navigator<"u"){this.isPhone=navigator.userAgent.toLowerCase().indexOf("mobile")!==-1;return}const{windowWidth:t}=i.index.getSystemInfoSync();this.isPhone=t<=500},methods:{leaveCale(){this.firstEnter=!0},handleMouse(t){if(t.disable||this.cale.lastHover)return;let{before:s,after:e}=this.cale.multipleStatus;s&&(this.calendar=t,this.cale.setHoverMultiple(this.calendar.fullDate),this.weeks=this.cale.weeks,this.firstEnter&&(this.$emit("firstEnterCale",this.cale.multipleStatus),this.firstEnter=!1))},rangeWithinMonth(t,s){const[e,h]=t.split("-"),[n,a]=s.split("-");return e===n&&h===a},maskClick(){this.close(),this.$emit("maskClose")},clearCalender(){this.range?(this.timeRange.startTime="",this.timeRange.endTime="",this.tempRange.before="",this.tempRange.after="",this.cale.multipleStatus.before="",this.cale.multipleStatus.after="",this.cale.multipleStatus.data=[],this.cale.lastHover=!1):(this.time="",this.tempSingleDate=""),this.calendar.fullDate="",this.setDate(new Date)},bindDateChange(t){const s=t.detail.value+"-1";this.setDate(s)},init(t){if(this.cale&&(this.cale.setDate(t||new Date),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(t),this.calendar={...this.nowDate},!t&&(this.calendar.fullDate="",this.defaultValue&&!this.range))){const s=new Date(this.defaultValue),e=c.getDate(s),h=s.getFullYear(),n=s.getMonth()+1,a=s.getDate(),l=s.getDay();this.calendar={fullDate:e,year:h,month:n,date:a,day:l},this.tempSingleDate=e,this.time=c.getTime(s,this.hideSecond)}},open(){this.clearDate&&!this.insert&&(this.cale.cleanMultipleStatus(),this.init(this.date)),this.show=!0,this.$nextTick(()=>{setTimeout(()=>{this.aniMaskShow=!0},50)})},close(){this.aniMaskShow=!1,this.$nextTick(()=>{setTimeout(()=>{this.show=!1,this.$emit("close")},300)})},confirm(){this.setEmit("confirm"),this.close()},change(){this.insert&&this.setEmit("change")},monthSwitch(){let{year:t,month:s}=this.nowDate;this.$emit("monthSwitch",{year:t,month:Number(s)})},setEmit(t){this.range||(this.calendar.fullDate||(this.calendar=this.cale.getInfo(new Date),this.tempSingleDate=this.calendar.fullDate),this.hasTime&&!this.time&&(this.time=c.getTime(new Date,this.hideSecond)));let{year:s,month:e,date:h,fullDate:n,extraInfo:a}=this.calendar;this.$emit(t,{range:this.cale.multipleStatus,year:s,month:e,date:h,time:this.time,timeRange:this.timeRange,fulldate:n,extraInfo:a||{}})},choiceDate(t){if(t.disable)return;this.calendar=t,this.calendar.userChecked=!0,this.cale.setMultiple(this.calendar.fullDate,!0),this.weeks=this.cale.weeks,this.tempSingleDate=this.calendar.fullDate;const s=new Date(this.cale.multipleStatus.before).getTime(),e=new Date(this.cale.multipleStatus.after).getTime();s>e&&e&&!this.isPhone?(this.tempRange.before=this.cale.multipleStatus.after,this.tempRange.after=this.cale.multipleStatus.before):(this.tempRange.before=this.cale.multipleStatus.before,this.tempRange.after=this.cale.multipleStatus.after),this.change()},changeMonth(t){let s;t==="pre"?s=this.cale.getPreMonthObj(this.nowDate.fullDate).fullDate:t==="next"&&(s=this.cale.getNextMonthObj(this.nowDate.fullDate).fullDate),this.setDate(s),this.monthSwitch()},setDate(t){this.cale.setDate(t),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(t)}}};if(!Array){const t=i.resolveComponent("calendar-item"),s=i.resolveComponent("time-picker"),e=i.resolveComponent("uni-icons");(t+s+e)()}const k=()=>"../../../uni-icons/components/uni-icons/uni-icons.js";Math||k();function S(t,s,e,h,n,a){return i.e({a:!e.insert&&n.show},!e.insert&&n.show?{b:n.aniMaskShow?1:"",c:i.o((...l)=>a.maskClick&&a.maskClick(...l))}:{},{d:e.insert||n.show},e.insert||n.show?i.e({e:i.o(l=>a.changeMonth("pre")),f:i.t((n.nowDate.year||"")+a.yearText+(n.nowDate.month||"")+a.monthText),g:e.date,h:i.o((...l)=>a.bindDateChange&&a.bindDateChange(...l)),i:i.o(l=>a.changeMonth("next")),j:!e.insert},e.insert?{}:{k:i.o((...l)=>a.close&&a.close(...l))},{l:e.insert?"":1,m:e.showMonth},e.showMonth?{n:i.t(n.nowDate.month)}:{},{o:i.t(a.SUNText),p:i.t(a.MONText),q:i.t(a.TUEText),r:i.t(a.WEDText),s:i.t(a.THUText),t:i.t(a.FRIText),v:i.t(a.SATText),w:i.f(n.weeks,(l,u,o)=>({a:i.f(l,(f,m,d)=>({a:i.o(a.choiceDate,m),b:i.o(a.handleMouse,m),c:"68ece0a7-0-"+o+"-"+d,d:i.p({weeks:f,calendar:n.calendar,selected:e.selected,checkHover:e.range}),e:m})),b:u})),x:!e.insert&&!e.range&&e.hasTime},!e.insert&&!e.range&&e.hasTime?{y:i.t(n.tempSingleDate?n.tempSingleDate:a.selectDateText),z:i.o(l=>n.time=l),A:i.p({type:"time",start:a.timepickerStartTime,end:a.timepickerEndTime,disabled:!n.tempSingleDate,border:!1,["hide-second"]:e.hideSecond,modelValue:n.time})}:{},{B:!e.insert&&e.range&&e.hasTime},!e.insert&&e.range&&e.hasTime?{C:i.t(n.tempRange.before?n.tempRange.before:a.startDateText),D:i.o(l=>n.timeRange.startTime=l),E:i.p({type:"time",start:a.timepickerStartTime,border:!1,["hide-second"]:e.hideSecond,disabled:!n.tempRange.before,modelValue:n.timeRange.startTime}),F:i.p({type:"arrowthinright",color:"#999"}),G:i.t(n.tempRange.after?n.tempRange.after:a.endDateText),H:i.o(l=>n.timeRange.endTime=l),I:i.p({type:"time",end:a.timepickerEndTime,border:!1,["hide-second"]:e.hideSecond,disabled:!n.tempRange.after,modelValue:n.timeRange.endTime})}:{},{J:!e.insert},e.insert?{}:{K:i.t(a.confirmText),L:i.o((...l)=>a.confirm&&a.confirm(...l))},{M:e.insert?"":1,N:n.aniMaskShow?1:"",O:n.aniMaskShow?1:""}):{},{P:i.o((...l)=>a.leaveCale&&a.leaveCale(...l))})}const b=i._export_sfc(w,[["render",S],["__file","C:/Users/lcz/Documents/GitHub/ZHJZ/uni_modules/uni-datetime-picker/components/uni-datetime-picker/calendar.vue"]]);wx.createComponent(b);
