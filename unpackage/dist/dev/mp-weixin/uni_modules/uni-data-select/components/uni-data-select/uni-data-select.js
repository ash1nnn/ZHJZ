"use strict";const i=require("../../../../common/vendor.js"),r={name:"uni-data-select",mixins:[i.Ds.mixinDatacom||{}],props:{localdata:{type:Array,default(){return[]}},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},placeholder:{type:String,default:"请选择"},emptyTips:{type:String,default:"无选项"},clear:{type:Boolean,default:!0},defItem:{type:Number,default:0},disabled:{type:Boolean,default:!1},format:{type:String,default:""}},data(){return{showSelector:!1,current:"",mixinDatacomResData:[],apps:[],channels:[],cacheKey:"uni-data-select-lastSelectedValue"}},created(){this.debounceGet=this.debounce(()=>{this.query()},300),this.collection&&!this.localdata.length&&this.debounceGet()},computed:{typePlaceholder(){const e={"opendb-stat-app-versions":"版本","opendb-app-channels":"渠道","opendb-app-list":"应用"},a=this.placeholder,t=e[this.collection];return t?a+t:a},valueCom(){return this.modelValue}},watch:{localdata:{immediate:!0,handler(e,a){Array.isArray(e)&&a!==e&&(this.mixinDatacomResData=e)}},valueCom(e,a){this.initDefVal()},mixinDatacomResData:{immediate:!0,handler(e){e.length&&this.initDefVal()}}},methods:{debounce(e,a=100){let t=null;return function(...s){t&&clearTimeout(t),t=setTimeout(()=>{e.apply(this,s)},a)}},query(){this.mixinDatacomEasyGet()},onMixinDatacomPropsChange(){this.collection&&this.debounceGet()},initDefVal(){let e="";if((this.valueCom||this.valueCom===0)&&!this.isDisabled(this.valueCom))e=this.valueCom;else{let t;if(this.collection&&(t=this.getCache()),t||t===0)e=t;else{let s="";this.defItem>0&&this.defItem<=this.mixinDatacomResData.length&&(s=this.mixinDatacomResData[this.defItem-1].value),e=s}(e||e===0)&&this.emit(e)}const a=this.mixinDatacomResData.find(t=>t.value===e);this.current=a?this.formatItemName(a):""},isDisabled(e){let a=!1;return this.mixinDatacomResData.forEach(t=>{t.value===e&&(a=t.disable)}),a},clearVal(){this.emit(""),this.collection&&this.removeCache()},change(e){e.disable||(this.showSelector=!1,this.current=this.formatItemName(e),this.emit(e.value))},emit(e){this.$emit("input",e),this.$emit("update:modelValue",e),this.$emit("change",e),this.collection&&this.setCache(e)},toggleSelector(){this.disabled||(this.showSelector=!this.showSelector)},formatItemName(e){let{text:a,value:t,channel_code:s}=e;if(s=s?`(${s})`:"",this.format){let c="";c=this.format;for(let l in e)c=c.replace(new RegExp(`{${l}}`,"g"),e[l]);return c}else return this.collection.indexOf("app-list")>0?`${a}(${t})`:a||`未命名${s}`},getLoadData(){return this.mixinDatacomResData},getCurrentCacheKey(){return this.collection},getCache(e=this.getCurrentCacheKey()){return(i.index.getStorageSync(this.cacheKey)||{})[e]},setCache(e,a=this.getCurrentCacheKey()){let t=i.index.getStorageSync(this.cacheKey)||{};t[a]=e,i.index.setStorageSync(this.cacheKey,t)},removeCache(e=this.getCurrentCacheKey()){let a=i.index.getStorageSync(this.cacheKey)||{};delete a[e],i.index.setStorageSync(this.cacheKey,a)}}};Array||i.resolveComponent("uni-icons")();const h=()=>"../../../uni-icons/components/uni-icons/uni-icons.js";Math||h();function u(e,a,t,s,c,l){return i.e({a:t.label},t.label?{b:i.t(t.label+"：")}:{},{c:c.current},c.current?{d:i.t(c.current)}:{e:i.t(l.typePlaceholder)},{f:c.current&&t.clear&&!t.disabled},c.current&&t.clear&&!t.disabled?{g:i.p({type:"clear",color:"#c0c4cc",size:"24"}),h:i.o((...n)=>l.clearVal&&l.clearVal(...n))}:{i:i.p({type:c.showSelector?"top":"bottom",size:"14",color:"#999"})},{j:i.o((...n)=>l.toggleSelector&&l.toggleSelector(...n)),k:c.showSelector},c.showSelector?{l:i.o((...n)=>l.toggleSelector&&l.toggleSelector(...n))}:{},{m:c.showSelector},c.showSelector?i.e({n:c.mixinDatacomResData.length===0},c.mixinDatacomResData.length===0?{o:i.t(t.emptyTips)}:{p:i.f(c.mixinDatacomResData,(n,o,d)=>({a:i.t(l.formatItemName(n)),b:n.disable?1:"",c:o,d:i.o(f=>l.change(n),o)}))}):{},{q:t.disabled?1:"",r:c.current?1:""})}const m=i._export_sfc(r,[["render",u],["__file","C:/Users/lcz/Documents/GitHub/ZHJZ/uni_modules/uni-data-select/components/uni-data-select/uni-data-select.vue"]]);wx.createComponent(m);
